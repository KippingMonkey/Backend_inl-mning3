@page
@model Musik_Affär.Pages.Carts.IndexModel

@{
    ViewData["Title"] = "Index";
}

<h1>Min Kundkorg</h1>
<h2>@Model.User.Identity.Name</h2>
<form method="get">
    <table>
        <tbody>
            <tr>
                <th><label for="SearchTerm">Sök</label></th>
                <td><input type="search" name="SearchTerm" id="SearchTerm" value="@Model.SearchTerm" placeholder="Vad letar du efter?"></td>
            </tr>
            <tr>
                <th><label for="SortColumn">Filtrera på:</label></th>
                <td>
                    <select asp-for="Brand" class="form-control" 
                     asp-items="Html.GetEnumSelectList<Musik_Affär.Models.Product.Manufacturer>()">
                    <option value="">Märke</option></select>

                     <select asp-for="Category"  
                      asp-items="Html.GetEnumSelectList<Musik_Affär.Models.Product.Type>()">
                         <option value="">Kategori</option> </select>

                    <select asp-for="Color" 
                     asp-items="Html.GetEnumSelectList<Musik_Affär.Models.Product.Style>()">
                         <option value="">Färg</option> </select>
                </td>
            </tr>
            <tr>
                <th><label for="SortColumn">Sortera efter:</label></th>
                <td>
                    <select asp-for="SortColumn" asp-items="Model.SortColumnList">
                        <option value="">Välj Sortering</option>
                    </select>
                    <select asp-for="Direction" asp-items="Model.DirectionList">
                         <option value="">Välj Ordning</option>
                    </select>
                </td>
            </tr>
        </tbody>
    </table>
    <button type="submit" class="submit-btn">Sök</button>
    <button asp-page-handler="Reset" type="reset">Nollställ sökning</button>
</form>

<table class="table" style="width:100%">
    <thead>
        <tr>
            <th>@Html.DisplayNameFor(model => model.Product.Name)</th>
            <th>@Html.DisplayNameFor(model => model.Product.Category)</th>
            <th>@Html.DisplayNameFor(model => model.Product.Color)</th>
            <th>@Html.DisplayNameFor(model => model.Product.Brand)</th>
            <th>@Html.DisplayNameFor(model => model.Product.Price)</th>
            <th>Antal</th>
            <th>Totalt</th>
            <th>Ändra</th>
        </tr>
    </thead>
       <tbody>
@for(int i = 0; i < Model.CartItems.Count(); i++) {
        <tr>
            <td> @Html.DisplayFor(model => model.CartItems[i].Product.Name )</td>
            <td> @Html.DisplayFor(model => model.CartItems[i].Product.Category )</td>
            <td> @Html.DisplayFor(model => model.CartItems[i].Product.Color )</td>
            <td> @Html.DisplayFor(model => model.CartItems[i].Product.Brand )</td>
            <td> @Html.DisplayFor(model => model.CartItems[i].Product.Price ) SEK</td>
            <td> @Html.DisplayFor(model => model.CartItems[i].Quantity )</td>
            <td> @Html.DisplayFor(model => model.TotalProductPrices[i])</td>
            <td>
                <form asp-page-handler="Plus" asp-page="Index" method="post" style="display:inline"  asp-route-id="@Model.CartItems[i].ProductID">
                    <button type="submit">+</button>
                </form>
                  <form asp-page-handler="Minus" asp-page="Index" method="post" style="display:inline" asp-route-id="@Model.CartItems[i].ProductID">
                    <button type="submit">-</button>
                </form>
                 <form asp-page-handler="Delete" asp-page="Index" method="post" style="display:inline" asp-route-id="@Model.CartItems[i].ProductID">
                    <button type="submit">Ta bort</button>
                </form>
                <a asp-page="./Details" asp-route-id="@Model.CartItems[i].ProductID"  class="crud-links">Detaljer</a>
            </td>
        </tr>
}       <tr></tr>
        @if (Model.CartItems.Count() != 0)
        {
            <tr>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td>Totalt: </td>
            <td>@Html.DisplayFor(model => model.TotalProductQty) produkter</td>
            <td> @Html.DisplayFor(model => model.TotalOrderPrice) SEK</td>
        </tr>
        }
    </tbody>
</table>
